// Start the backend server when Electron is ready
const startBackendServer = () => {
  const { exec } = require('child_process')
  exec('cd backend && npm start', (err, stdout, stderr) => {
    if (err) {
      console.error(`Error starting backend server: ${stderr}`)
    } else {
      console.log(`Backend server started: ${stdout}`)
    }
  })
}

// This method will be called when Electron has finished
// initialization and is ready to create browser windows.
// Some APIs can only be used after this event occurs.
app.on('ready', async () => {
  startBackendServer()
  if (isDevelopment && !process.env.IS_TEST) {
    // Install Vue Devtools
    try {
      await installExtension(VUEJS_DEVTOOLS)
    } catch (e) {
      console.error('Vue Devtools failed to install:', e.toString())
    }
  }
  createWindow()
})